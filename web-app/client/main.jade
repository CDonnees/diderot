template(name="Home")
  script(src="https://cdnjs.cloudflare.com/ajax/libs/rasterizehtml/1.2.4/rasterizeHTML.allinone.js" type="text/javascript")
  .navbar-fixed
    nav
      .nav-wrapper
        a(href="#" class="brand-logo")
          img.nav-logo(src="/QDDiderot-logo.png")
          span Que Dirait Diderot ?
        //- <ul id="nav-mobile" class="right hide-on-med-and-down">
        //-   <li><a href="sass.html">Sass</a></li>
        //-   <li><a href="badges.html">Components</a></li>
        //-   <li><a href="collapsible.html">JavaScript</a></li>
        //- </ul>

  .fixed-selection-col
    if state.searchLoading
      .tags-box.center 
        h5 Votre recherche
        .tag Chargement...
    else if state.newSearchId
      .tags-box.center 
        h5 Votre recherche
        each tag in newSearch.originalTags
          .tag #{tag}

    else
      .tags-box.center 
        h5 Votre recherche
      .search-box.input-field
        input#tag-search(placeholder="Entre tes mots-clefs !" type="text" class="validate")
        button#js-send-search(class="btn waves-effect waves-light" type="submit" name="action") Chercher
    .tags-box.center 
      h5 Derniers mots-clés
      each tag in allTags
        .tag(class="{{#if (isSelectedTag tag)}}tag-active{{/if}}") #{tag}

  .page-container
    .row
      .col.s12.m9.offset-m3
        .results-container.center
          if state.newSearchId
            if $eq newSearch.answers.count 0
              h5.results-title Votre requête n'a pas donné de résultat... Réessayez !
              p.js-cancel(style="text-decoration:underline;  color: gray;") Retour
            else
              h5.results-title Choississez un résultat parmi:
              p.js-cancel(style="text-decoration:underline;  color: gray;") Retour
              .results-grid#search-answers-grid
                each answer in newSearch.answers
                  if answer.text
                    //- Text Img for plain text
                    .result-card.z-depth-1(style="background-color:{{answerColor answer._id}};" data-index=answer._id)
                      .result-buttons
                        a(data-index=answer._id href="").js-validate-answer
                            .share-twitter Valider cette phrase
                      .result-img-header # Que Dirait Diderot ?
                      .result-img-text "#{answer.text}"
                      .result-img-ref #{answer.title}
                  else if answer.finalImage
                    .result-card.z-depth-1(style="background-color:{{answerColor answer._id}};")
                      //- Image only
                      img(src=answer.finalImage)
                  else
                    .result-card.z-depth-1(style="background-color:{{answerColor answer._id}};")
                      //- Image + title
                      img(src=answer.imageUrl)
                      .result-image-title #{answer.title}


          
          if $eq selectedAnswers.length 0
            if $not state.newSearchId
              h5.results-title Faites une recherche ou cliquez sur des tags !
          else
            h5.results-title Résultats Correspondants
            .results-grid#tags-answers-grid
              each answer in selectedAnswers
                if answer.text
                  .result-card.z-depth-1(style="background-color:{{answerColor answer._id}};" id=answer._id data-index=answer._id )
                    //- Text Img for plain text
                    .result-buttons
                      if $not answer.finalImage
                        .loading(style="display: none;")|#{getGoodTwitterImage answer._id}
                        a(href="")
                          .share-twitter Création du partage twitter...
                      else
                        a(href=answer.finalMessage target="_blank")
                          span.share-twitter
                            i.material-icons share
                            |Twitter
                      
                      a(href=answer.resourceUrl target="_blank")
                        span.open-gallica
                          i.material-icons loupe
                          |Gallica
                    .result-img-header # Que Dirait Diderot ?
                    .result-img-text "#{answer.text}"
                    .result-img-ref #{answer.title} #{answer._id}

                else if answer.finalImage
                  .result-card.z-depth-1(style="background-color:{{answerColor answer._id}};")
                    //- Image only
                    .result-buttons
                      a(href=answer.finalMessage target="_blank")
                        span.share-twitter
                          i.material-icons share
                          |Twitter
                      a(href=answer.resourceUrl target="_blank")
                        span.open-gallica
                          i.material-icons loupe
                          |Gallica
                    img(src=answer.finalImage)
                else
                  .result-card.z-depth-1(style="background-color:{{answerColor answer._id}};")
                    //- Image + title
                    .result-buttons
                      a(href=answer.finalMessage target="_blank")
                        span.share-twitter
                          i.material-icons share
                          |Twitter
                      a(href=answer.resourceUrl target="_blank")
                        span.open-gallica
                          i.material-icons loupe
                          |Gallica
                    img(src=answer.imageUrl)
                    .result-image-title #{answer.title}
  canvas(id="canvas" width="800" height="600" style="opacity: 0; z-index: -99999; position:fixed;")



template(name="AnswerPage")
  #answer-page
    .navbar-fixed
      nav
        .nav-wrapper
          a(href="#" class="brand-logo")
            img.nav-logo(src="/QDDiderot-logo.png")
            span Que Dirait Diderot ?
    h2.center Yolo answer page
    .container.center
      .result-card.z-depth-1
        .result-buttons
          a(data-index=answer._id href="").js-validate-answer
              .share-twitter Valider cette phrase
        .result-img-header # Que Dirait Diderot ?
        .result-img-text "Si l'on ajoute aux Michel, les Michèle, Mickaël, Jean-Michel, sans oublier les Gabriel et Raphaël, il y a bien un million et demi de Français à qui l'on peut, en ce jour, dire bonne fête"
        .result-img-ref MOEURS ET HUMEURS DES FRANÇAIS AU FIL DES SAISONS / PHILIPPE BESNARD

